<!DOCTYPE html>
<html>
<head>
    <title>Simple Game</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        #character { font-size: 24px; margin: 20px; }
        #map { display: grid; grid-template-columns: repeat(10, 30px); grid-template-rows: repeat(10, 30px); margin: 20px auto; border: 1px solid black; width: 300px; height: 300px; }
        .tile { width: 30px; height: 30px; border: 1px solid #ccc; display: flex; align-items: center; justify-content: center; font-size: 12px; }
        .empty { background-color: #f0f0f0; }
        .wall { background-color: #666; }
        .player { background-color: #ff0; }
        button { margin: 10px; padding: 10px 20px; }
    </style>
</head>
<body>
    <h1>Simple Character Game</h1>
    <div id="character">Character at (0, 0) - Health: 100</div>
    <div id="map"></div>
    <div>
        <button onclick="move('up')">Up</button><br>
        <button onclick="move('left')">Left</button>
        <button onclick="move('right')">Right</button><br>
        <button onclick="move('down')">Down</button>
    </div>
    <script>
        async function updateMap() {
            try {
                const [mapResponse, charResponse] = await Promise.all([
                    fetch('/map'),
                    fetch('/character')
                ]);

                if (!mapResponse.ok || !charResponse.ok) {
                    throw new Error('Failed to fetch game data');
                }

                const map = await mapResponse.json();
                const char = await charResponse.json();

                const mapDiv = document.getElementById('map');
                mapDiv.innerHTML = '';

                for (let y = 0; y < map.height; y++) {
                    for (let x = 0; x < map.width; x++) {
                        const tile = document.createElement('div');
                        tile.className = 'tile ' + map.tiles[y][x];
                        if (x === char.x && y === char.y) {
                            tile.className += ' player';
                            tile.innerText = 'P';
                        } else if (map.tiles[y][x] === 'wall') {
                            tile.innerText = '#';
                        }
                        mapDiv.appendChild(tile);
                    }
                }

                document.getElementById('character').innerText = `Character at (${char.x}, ${char.y}) - Health: ${char.health}`;
            } catch (error) {
                console.error('Error updating map:', error);
            }
        }

        async function move(direction) {
            try {
                const response = await fetch('/move', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ direction })
                });

                if (!response.ok) {
                    throw new Error('Move failed');
                }

                await updateMap();
            } catch (error) {
                console.error('Error moving:', error);
            }
        }

        updateMap();
    </script>
</body>
</html>